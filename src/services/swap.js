const _0x5983e5=_0x430c;(function(_0x56ba6e,_0xc37eb4){const _0xb10112=_0x430c,_0x7f882c=_0x56ba6e();while(!![]){try{const _0xaa17d5=-parseInt(_0xb10112(0x19e))/0x1+parseInt(_0xb10112(0x197))/0x2+parseInt(_0xb10112(0x194))/0x3*(-parseInt(_0xb10112(0x187))/0x4)+parseInt(_0xb10112(0x186))/0x5+parseInt(_0xb10112(0x188))/0x6+parseInt(_0xb10112(0x1c4))/0x7+-parseInt(_0xb10112(0x1b3))/0x8;if(_0xaa17d5===_0xc37eb4)break;else _0x7f882c['push'](_0x7f882c['shift']());}catch(_0x14e902){_0x7f882c['push'](_0x7f882c['shift']());}}}(_0x331e,0x5ad44));import{ethers}from'ethers';function _0x331e(){const _0x1529eb=['[SUCCESS]\x20USDT\x20approved\x20successfully.','refreshEoaBalance','2723820ZiyzDz','3484DDAsPo','1203762LEcYfM','provider','ceil','WKITE','executeSwapCycle','uint8','[WARN]\x20Low\x20KITE\x20balance\x20on\x20EOA.\x20Attempting\x20to\x20withdraw\x20','SWAP_ROUTER','[INFO]\x20Amount:\x20','initiate','[ERROR]\x20Final\x20USDT\x20cleanup\x20swap\x20failed:\x20','ZERO_ADDRESS','1434kvRTLj','formatUnits','parseUnits','901858pkRtfq','allowance','[INFO]\x20Sending\x20swap\x20transaction...','RPC_URL','encode','Swap\x20Failed','decimals','559810BMfQvd','Processing\x20Swap..','MAX_SWAP_COUNT','\x20balance\x20for\x20swap.\x20Skipping.','getBalance','addDebugMessage','dashboard','\x20failed:\x20','[INFO]\x20Checking\x20for\x20any\x20remaining\x20USDT\x20to\x20swap\x20back\x20to\x20KITE.','Swap\x20Completed','updateStatus','balanceOf','Contract',',\x20Balance:\x20','[SUCCESS]\x20Swap\x20successful!\x20Tx:\x20','[INFO]\x20Starting\x20swap\x20cycle...','KITE_TO_USDT','wait','formatEther','[INFO]\x20Waiting\x20~','KITE_AI','3161648NuuVmb','MIN_SWAP_COUNT','[INFO]\x20Approving\x20USDT\x20for\x20swap...','[INFO]\x20Waiting\x2030s\x20for\x20withdrawal\x20to\x20confirm...','[INFO]\x20Checking\x20USDT\x20allowance\x20for\x20swap...','truncateAddress','USDT','[INFO]\x20Estimating\x20gas\x20for\x20swap...','_executeSwap','address','Swap\x20cycle\x20Error','\x20alternating\x20swap(s).','[INFO]\x20No\x20remaining\x20USDT\x20to\x20swap.','\x20KITE\x20from\x20SA\x20for\x20gas\x20fees.','estimateGas','AbiCoder','Wallet','3829490AgQaJC','s\x20before\x20next\x20swap...','message','[INFO]\x20EOA\x20KITE\x20balance\x20for\x20gas:\x20','defaultAbiCoder','KITE','floor','USDT_TO_KITE','[ERROR]\x20Swap\x20attempt\x20','ERC20','[WARN]\x20Insufficient\x20','[INFO]\x20Swapping\x20remaining\x20','withdrawService','withdrawNativeKite'];_0x331e=function(){return _0x1529eb;};return _0x331e();}function _0x430c(_0x32981f,_0x103bcc){const _0x331e4e=_0x331e();return _0x430c=function(_0x430c75,_0x14f299){_0x430c75=_0x430c75-0x17a;let _0x2532ee=_0x331e4e[_0x430c75];return _0x2532ee;},_0x430c(_0x32981f,_0x103bcc);}import{Config}from'../../config.js';import{NETWORKS,CONTRACTS,ABIS,DEST_BLOCKCHAIN_ID}from'../core/network.js';async function pureDelay(_0x3739f2){return new Promise(_0x20997f=>setTimeout(_0x20997f,_0x3739f2));}function getRandomInt(_0x43bd97,_0x27de7c){const _0x32b912=_0x430c;return _0x43bd97=Math[_0x32b912(0x18a)](_0x43bd97),_0x27de7c=Math['floor'](_0x27de7c),Math[_0x32b912(0x17c)](Math['random']()*(_0x27de7c-_0x43bd97+0x1))+_0x43bd97;}export class SwapService{constructor(_0x59989b,_0x4fbb56){const _0x58e49c=_0x430c;this[_0x58e49c(0x1a4)]=_0x59989b,this[_0x58e49c(0x182)]=_0x4fbb56,this['provider']=new ethers['JsonRpcProvider'](NETWORKS[_0x58e49c(0x1b2)][_0x58e49c(0x19a)]);}['buildInstructionsData'](_0x574c5b,_0x477752,_0x19bad0,_0xaa9a47){const _0x4c4506=_0x430c,_0x502fd0=!_0x477752,_0xcae35e=ethers[_0x4c4506(0x1c2)][_0x4c4506(0x17a)]()[_0x4c4506(0x19b)]([_0x4c4506(0x18d),'uint8','uint256','uint256',_0x4c4506(0x1bc),_0x4c4506(0x1bc),_0x4c4506(0x1bc)],[0x20,0x60,0x0,0x0,'0x0000000000000000000000000000000000000002',_0x19bad0,_0xaa9a47]);return[0x1,_0x574c5b,_0x502fd0,_0x574c5b,0x0,0x7a120,[[0x3,0x27fa60,0x205940,_0xcae35e,[CONTRACTS[_0x4c4506(0x193)],![],CONTRACTS[_0x4c4506(0x193)],CONTRACTS['SWAP_ROUTER'],DEST_BLOCKCHAIN_ID,0x0,0x0]]]];}async['_executeSwap'](_0x2cd053,_0x2e23be,_0x1da1f6,_0x26c96c,_0x3d9c5b,_0x2daf79){const _0x3c0cd5=_0x430c,_0x4c4a21=new ethers[(_0x3c0cd5(0x1c3))](_0x2cd053,this['provider']),_0x480971=_0x4c4a21[_0x3c0cd5(0x1bc)],_0x551036=_0x2e23be==='KITE_TO_USDT',_0x45a6c2=ethers[_0x3c0cd5(0x196)](_0x3d9c5b,_0x2daf79),_0x5926df=new ethers[(_0x3c0cd5(0x1aa))](CONTRACTS['SWAP_ROUTER'],ABIS[_0x3c0cd5(0x18f)],_0x4c4a21);if(!_0x551036){const _0x3b562a=new ethers['Contract'](_0x1da1f6,ABIS['ERC20'],_0x4c4a21);this[_0x3c0cd5(0x1a4)]['addDebugMessage'](_0x3c0cd5(0x1b7));const _0x520d49=await _0x3b562a[_0x3c0cd5(0x198)](_0x480971,CONTRACTS['SWAP_ROUTER']);if(_0x520d49<_0x45a6c2){this[_0x3c0cd5(0x1a4)][_0x3c0cd5(0x1a3)](_0x3c0cd5(0x1b5));const _0x37cdaf=await _0x3b562a['approve'](CONTRACTS[_0x3c0cd5(0x18f)],_0x45a6c2);await _0x37cdaf['wait'](),this['dashboard'][_0x3c0cd5(0x1a3)](_0x3c0cd5(0x184));}}const _0x279fca=this['buildInstructionsData'](_0x480971,_0x551036,_0x1da1f6,_0x26c96c),_0x4d3350=_0x551036?CONTRACTS['ZERO_ADDRESS']:_0x1da1f6,_0x14a120=[_0x4d3350,_0x45a6c2,_0x279fca],_0x2a240e=_0x551036?{'value':_0x45a6c2}:{};this['dashboard']['addDebugMessage'](_0x3c0cd5(0x1ba));const _0x5bd636=await _0x5926df[_0x3c0cd5(0x191)][_0x3c0cd5(0x1c1)](..._0x14a120,_0x2a240e);_0x2a240e['gasLimit']=_0x5bd636*0x78n/0x64n,this[_0x3c0cd5(0x1a4)][_0x3c0cd5(0x1a3)](_0x3c0cd5(0x199));const _0x34a576=await _0x5926df[_0x3c0cd5(0x191)](..._0x14a120,_0x2a240e);return await _0x34a576[_0x3c0cd5(0x1af)](),_0x34a576['hash'];}async[_0x5983e5(0x18c)](_0x55b8e3,_0x217504,_0x4fb008){const _0x51c872=_0x5983e5;this[_0x51c872(0x1a4)][_0x51c872(0x1a3)](_0x51c872(0x1ad)),_0x217504[_0x51c872(0x1a8)]('Starting\x20Swap\x20Cycle..');const _0x4646d9=new ethers[(_0x51c872(0x1c3))](_0x55b8e3,this[_0x51c872(0x189)]),_0x48d33f=_0x4646d9[_0x51c872(0x1bc)],_0x5c924c=0.01,_0x2cd2e4=0.1;try{const _0x2ff7b2=await this[_0x51c872(0x189)][_0x51c872(0x1a2)](_0x48d33f),_0x59c488=parseFloat(ethers[_0x51c872(0x1b0)](_0x2ff7b2));this[_0x51c872(0x1a4)][_0x51c872(0x1a3)](_0x51c872(0x1c7)+_0x59c488['toFixed'](0x4)+'\x20KITE'),_0x59c488<_0x5c924c&&(this[_0x51c872(0x1a4)][_0x51c872(0x1a3)](_0x51c872(0x18e)+_0x2cd2e4+_0x51c872(0x1c0)),await this[_0x51c872(0x182)][_0x51c872(0x183)](_0x4fb008,_0x2cd2e4,_0x217504),this[_0x51c872(0x1a4)][_0x51c872(0x1a3)](_0x51c872(0x1b6)),await pureDelay(0x7530));}catch(_0x21b34b){this[_0x51c872(0x1a4)]['addDebugMessage']('[ERROR]\x20Failed\x20during\x20gas\x20check/withdrawal\x20process:\x20'+_0x21b34b['message']);}const _0x453471=getRandomInt(Config[_0x51c872(0x1b4)],Config[_0x51c872(0x1a0)])||getRandomInt(0xa,0x14);this[_0x51c872(0x1a4)][_0x51c872(0x1a3)]('[INFO]\x20Performing\x20'+_0x453471+_0x51c872(0x1be));let _0x4bd05e='KITE_TO_USDT';for(let _0xd3a092=0x0;_0xd3a092<_0x453471;_0xd3a092++){await _0x217504[_0x51c872(0x185)](),await _0x217504[_0x51c872(0x1a8)](_0x51c872(0x19f));let _0x3475fa,_0x1da57a,_0x321d69,_0x5d35cc,_0x1915e4,_0x410943;const _0x30d7da=new ethers['Contract'](CONTRACTS[_0x51c872(0x1b9)],ABIS[_0x51c872(0x17f)],this[_0x51c872(0x189)]),_0x3b61ba=await _0x30d7da[_0x51c872(0x19d)]();if(_0x4bd05e===_0x51c872(0x1ae)){_0x3475fa=CONTRACTS[_0x51c872(0x18b)],_0x1da57a=CONTRACTS[_0x51c872(0x1b9)],_0x321d69=(getRandomInt(0x1,0x5)/0x64)['toString'](),_0x5d35cc=ethers['formatEther'](await this['provider'][_0x51c872(0x1a2)](_0x48d33f)),_0x1915e4=_0x51c872(0x17b),_0x410943=0x12;if(parseFloat(_0x5d35cc)<parseFloat(_0x321d69)){this[_0x51c872(0x1a4)]['addDebugMessage']('[WARN]\x20Insufficient\x20'+_0x1915e4+'\x20balance\x20for\x20swap.\x20Skipping.'),_0x4bd05e=_0x51c872(0x17d);continue;}}else{_0x3475fa=CONTRACTS[_0x51c872(0x1b9)],_0x1da57a=CONTRACTS[_0x51c872(0x18b)],_0x5d35cc=ethers[_0x51c872(0x195)](await _0x30d7da[_0x51c872(0x1a9)](_0x48d33f),_0x3b61ba),_0x321d69=_0x5d35cc,_0x1915e4=_0x51c872(0x1b9),_0x410943=_0x3b61ba;if(parseFloat(_0x321d69)<0.0001){this[_0x51c872(0x1a4)]['addDebugMessage'](_0x51c872(0x180)+_0x1915e4+_0x51c872(0x1a1)),_0x4bd05e=_0x51c872(0x1ae);continue;}}this[_0x51c872(0x1a4)]['addDebugMessage']('[INFO]\x20Swap\x20'+(_0xd3a092+0x1)+'/'+_0x453471+':\x20'+_0x1915e4+'\x20->\x20'+(_0x4bd05e===_0x51c872(0x1ae)?'USDT':_0x51c872(0x17b))),this[_0x51c872(0x1a4)][_0x51c872(0x1a3)](_0x51c872(0x190)+_0x321d69+'\x20'+_0x1915e4+_0x51c872(0x1ab)+parseFloat(_0x5d35cc)['toFixed'](0x4)+'\x20'+_0x1915e4);let _0x94f0f2=![],_0x456a23=0x0;const _0x4f03f2=0x3;while(!_0x94f0f2&&_0x456a23<_0x4f03f2){_0x456a23++;try{const _0x56b643=await this[_0x51c872(0x1bb)](_0x55b8e3,_0x4bd05e,_0x3475fa,_0x1da57a,_0x321d69,_0x410943);this['dashboard'][_0x51c872(0x1a3)](_0x51c872(0x1ac)+this[_0x51c872(0x1a4)][_0x51c872(0x1b8)](_0x56b643)),_0x94f0f2=!![],await _0x217504[_0x51c872(0x1a8)](_0x51c872(0x1a7));}catch(_0x33bef1){this['dashboard']['addDebugMessage'](_0x51c872(0x17e)+_0x456a23+'/'+_0x4f03f2+_0x51c872(0x1a5)+_0x33bef1[_0x51c872(0x1c6)]),_0x456a23<_0x4f03f2?await pureDelay(0x5*0x3e8):_0x217504[_0x51c872(0x1a8)](_0x51c872(0x19c));}}_0x4bd05e=_0x4bd05e===_0x51c872(0x1ae)?_0x51c872(0x17d):_0x51c872(0x1ae);if(_0xd3a092<_0x453471-0x1){const _0xcb0066=getRandomInt(0x5,0x14);this[_0x51c872(0x1a4)][_0x51c872(0x1a3)](_0x51c872(0x1b1)+_0xcb0066+_0x51c872(0x1c5)),await pureDelay(_0xcb0066*0x457);}}this[_0x51c872(0x1a4)][_0x51c872(0x1a3)](_0x51c872(0x1a6));try{await _0x217504[_0x51c872(0x185)]();const _0x98726c=new ethers[(_0x51c872(0x1aa))](CONTRACTS[_0x51c872(0x1b9)],ABIS['ERC20'],this[_0x51c872(0x189)]),_0x52b120=await _0x98726c[_0x51c872(0x19d)](),_0x587146=ethers[_0x51c872(0x195)](await _0x98726c['balanceOf'](_0x48d33f),_0x52b120);if(parseFloat(_0x587146)>=0.01){this[_0x51c872(0x1a4)][_0x51c872(0x1a3)](_0x51c872(0x181)+_0x587146+'\x20USDT\x20back\x20to\x20KITE.');const _0x7c4c6d=await this['_executeSwap'](_0x55b8e3,_0x51c872(0x17d),CONTRACTS[_0x51c872(0x1b9)],CONTRACTS[_0x51c872(0x18b)],_0x587146,_0x52b120);this[_0x51c872(0x1a4)][_0x51c872(0x1a3)]('[SUCCESS]\x20Final\x20cleanup\x20swap\x20successful!\x20Tx:\x20'+this[_0x51c872(0x1a4)][_0x51c872(0x1b8)](_0x7c4c6d));}else this[_0x51c872(0x1a4)][_0x51c872(0x1a3)](_0x51c872(0x1bf));}catch(_0x44c23f){this[_0x51c872(0x1a4)][_0x51c872(0x1a3)](_0x51c872(0x192)+_0x44c23f[_0x51c872(0x1c6)]),_0x217504[_0x51c872(0x1a8)](_0x51c872(0x1bd));}this['dashboard']['addDebugMessage']('[SUCCESS]\x20Swap\x20cycle\x20finished.');}}